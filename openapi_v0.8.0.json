{
  "openapi": "3.1.0",
  "info": {
    "title": "sisRUA API",
    "description": "\n**sisRUA** - Generative Urban Design System for AutoCAD.\n\nThis API powers the AutoCAD plugin for:\n- Fetching and projecting **OpenStreetMap** data\n- Processing **GeoJSON** files for CAD import\n- Providing **elevation data** from SRTM sources\n- Managing **asynchronous jobs** for long-running operations\n\n## Authentication\nProtected endpoints require the `X-SisRua-Token` header.\n    ",
    "version": "0.8.0"
  },
  "paths": {
    "/api/v1/auth/check": {
      "get": {
        "tags": [
          "Health"
        ],
        "summary": "Auth Check",
        "description": "Check if the provided authentication token is valid.",
        "operationId": "auth_check_api_v1_auth_check_get",
        "parameters": [
          {
            "name": "X-SisRua-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Sisrua-Token"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/health": {
      "get": {
        "tags": [
          "Health"
        ],
        "summary": "Health",
        "description": "Simple health check to verify the API server is up and running.",
        "operationId": "health_api_v1_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/health/detailed": {
      "get": {
        "tags": [
          "Health"
        ],
        "summary": "Health Detailed",
        "description": "Deep health check verifying DB, Cache, and Configuration.",
        "operationId": "health_detailed_api_v1_health_detailed_get",
        "parameters": [
          {
            "name": "X-SisRua-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Sisrua-Token"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeepHealthResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/projects/{project_id}": {
      "put": {
        "tags": [
          "Projects"
        ],
        "summary": "Update Project",
        "description": "Update project metadata safely using Optimistic Locking.\nRequires 'version' in body matching the database version.",
        "operationId": "update_project_api_v1_projects__project_id__put",
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Project Id"
            }
          },
          {
            "name": "X-SisRua-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Sisrua-Token"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectUpdateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/prepare": {
      "post": {
        "tags": [
          "Jobs"
        ],
        "summary": "Create Prepare Job",
        "description": "Start an asynchronous data preparation job (OSM or GeoJSON). returns the initial job status.",
        "operationId": "create_prepare_job_api_v1_jobs_prepare_post",
        "parameters": [
          {
            "name": "X-SisRua-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Sisrua-Token"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PrepareJobRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JobStatusResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/{job_id}": {
      "get": {
        "tags": [
          "Jobs"
        ],
        "summary": "Get Job Endpoint",
        "description": "Retrieve the current status, progress, and result (if completed) of a job.",
        "operationId": "get_job_endpoint_api_v1_jobs__job_id__get",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          },
          {
            "name": "X-SisRua-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Sisrua-Token"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JobStatusResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Jobs"
        ],
        "summary": "Cancel Job Endpoint",
        "description": "Request cancellation of a running job.",
        "operationId": "cancel_job_endpoint_api_v1_jobs__job_id__delete",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          },
          {
            "name": "X-SisRua-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Sisrua-Token"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/tools/elevation/query": {
      "post": {
        "tags": [
          "Tools"
        ],
        "summary": "Query Elevation",
        "description": "Query numeric elevation (Z) at a single lat/lon point.",
        "operationId": "query_elevation_api_v1_tools_elevation_query_post",
        "parameters": [
          {
            "name": "X-SisRua-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Sisrua-Token"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ElevationQueryRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ElevationPointResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/tools/elevation/profile": {
      "post": {
        "tags": [
          "Tools"
        ],
        "summary": "Query Profile",
        "description": "Retrieve an elevation profile (list of Z values) along a given path.",
        "operationId": "query_profile_api_v1_tools_elevation_profile_post",
        "parameters": [
          {
            "name": "X-SisRua-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Sisrua-Token"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ElevationProfileRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ElevationProfileResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/ai/chat": {
      "post": {
        "tags": [
          "AI"
        ],
        "summary": "Chat With Ai",
        "description": "Interact with sisRUA AI based on Groq.",
        "operationId": "chat_with_ai_api_v1_ai_chat_post",
        "parameters": [
          {
            "name": "X-SisRua-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Sisrua-Token"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChatRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ChatResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/prepare/osm": {
      "post": {
        "tags": [
          "Prepare"
        ],
        "summary": "Prepare Osm",
        "description": "Synchronous OSM data preparation. \nDownloads OSM data in lat/lon (EPSG:4326), projects to SIRGAS 2000 UTM, \nand returns a list of CAD-ready features.",
        "operationId": "prepare_osm_api_v1_prepare_osm_post",
        "parameters": [
          {
            "name": "X-SisRua-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Sisrua-Token"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PrepareOsmRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PrepareResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/prepare/geojson": {
      "post": {
        "tags": [
          "Prepare"
        ],
        "summary": "Prepare Geojson",
        "description": "Synchronous GeoJSON data preparation.\nAccepts GeoJSON (EPSG:4326), projects to SIRGAS 2000 UTM, \nand returns a list of CAD-ready features.",
        "operationId": "prepare_geojson_api_v1_prepare_geojson_post",
        "parameters": [
          {
            "name": "X-SisRua-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Sisrua-Token"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PrepareGeoJsonRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PrepareResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/webhooks/register": {
      "post": {
        "tags": [
          "Webhooks"
        ],
        "summary": "Register Webhook",
        "description": "Register a new URL to receive system events via webhook.",
        "operationId": "register_webhook_api_v1_webhooks_register_post",
        "parameters": [
          {
            "name": "X-SisRua-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Sisrua-Token"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WebhookRegistrationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/events/emit": {
      "post": {
        "tags": [
          "Webhooks"
        ],
        "summary": "Emit Event",
        "description": "Internal endpoint for the AutoCAD plugin to emit events for webhook broadcasting.\ne.g. project_saved, project_loaded.",
        "operationId": "emit_event_api_v1_events_emit_post",
        "parameters": [
          {
            "name": "X-SisRua-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Sisrua-Token"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/InternalEvent"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/audit": {
      "post": {
        "tags": [
          "Audit"
        ],
        "summary": "Create Audit Log",
        "description": "Create audit log entry (called from C# plugin or other services).",
        "operationId": "create_audit_log_api_audit_post",
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "Audit"
        ],
        "summary": "List Audit Logs",
        "description": "List audit logs with optional filters.",
        "operationId": "list_audit_logs_api_audit_get",
        "parameters": [
          {
            "name": "entity_type",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Entity Type"
            }
          },
          {
            "name": "entity_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Entity Id"
            }
          },
          {
            "name": "event_type",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Event Type"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 1000,
              "minimum": 1,
              "default": 100,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/audit/{audit_id}": {
      "get": {
        "tags": [
          "Audit"
        ],
        "summary": "Get Audit Log",
        "description": "Get a specific audit log entry.",
        "operationId": "get_audit_log_api_audit__audit_id__get",
        "parameters": [
          {
            "name": "audit_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Audit Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/audit/{audit_id}/verify": {
      "get": {
        "tags": [
          "Audit"
        ],
        "summary": "Verify Audit Log",
        "description": "Verify audit log signature to detect tampering.",
        "operationId": "verify_audit_log_api_audit__audit_id__verify_get",
        "parameters": [
          {
            "name": "audit_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Audit Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/audit/verify-all": {
      "post": {
        "tags": [
          "Audit"
        ],
        "summary": "Verify All Logs",
        "description": "Verify all recent audit logs for integrity checking.",
        "operationId": "verify_all_logs_api_audit_verify_all_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/api/audit/stats": {
      "get": {
        "tags": [
          "Audit"
        ],
        "summary": "Get Audit Stats",
        "description": "Get audit log statistics.",
        "operationId": "get_audit_stats_api_audit_stats_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/": {
      "get": {
        "summary": "Root",
        "operationId": "root__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "CadFeature": {
        "properties": {
          "feature_type": {
            "type": "string",
            "enum": [
              "Polyline",
              "Point"
            ],
            "title": "Feature Type",
            "description": "CAD entity type",
            "default": "Polyline"
          },
          "layer": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Layer",
            "description": "Target AutoCAD layer name"
          },
          "name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Name",
            "description": "Display name for the feature"
          },
          "highway": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Highway",
            "description": "OSM highway tag value"
          },
          "width_m": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Width M",
            "description": "Estimated width in meters"
          },
          "coords_xy": {
            "anyOf": [
              {
                "items": {
                  "items": {
                    "type": "number"
                  },
                  "type": "array"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Coords Xy",
            "description": "Coordinates in projected CRS (SIRGAS 2000)"
          },
          "insertion_point_xy": {
            "anyOf": [
              {
                "items": {
                  "type": "number"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Insertion Point Xy",
            "description": "Insertion point in projected CRS"
          },
          "block_name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Block Name",
            "description": "Name of the AutoCAD block"
          },
          "block_filepath": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Block Filepath",
            "description": "Path to the block definition file"
          },
          "rotation": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Rotation",
            "description": "Rotation in radians"
          },
          "scale": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Scale",
            "description": "Scale factor"
          },
          "color": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Color",
            "description": "ACI color code or RGB string"
          },
          "elevation": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Elevation",
            "description": "Elevation (Z value) in meters"
          },
          "slope": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Slope",
            "description": "Calculated slope percentage"
          }
        },
        "type": "object",
        "title": "CadFeature"
      },
      "ChatRequest": {
        "properties": {
          "message": {
            "type": "string",
            "title": "Message"
          },
          "context": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Context"
          },
          "job_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Job Id"
          }
        },
        "type": "object",
        "required": [
          "message"
        ],
        "title": "ChatRequest"
      },
      "ChatResponse": {
        "properties": {
          "response": {
            "type": "string",
            "title": "Response"
          }
        },
        "type": "object",
        "required": [
          "response"
        ],
        "title": "ChatResponse"
      },
      "ComponentHealth": {
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "up",
              "down",
              "degraded"
            ],
            "title": "Status",
            "description": "Status of the specific component"
          },
          "details": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Details",
            "description": "Error message or metadata"
          },
          "latency_ms": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Latency Ms",
            "description": "Response time in milliseconds"
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "ComponentHealth"
      },
      "DeepHealthResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "description": "Operational status of the API",
            "example": "ok"
          },
          "components": {
            "additionalProperties": {
              "$ref": "#/components/schemas/ComponentHealth"
            },
            "type": "object",
            "title": "Components",
            "description": "Health status of internal dependencies"
          },
          "system_latency_ms": {
            "type": "number",
            "title": "System Latency Ms",
            "description": "Total time taken to perform health check"
          }
        },
        "type": "object",
        "required": [
          "status",
          "components",
          "system_latency_ms"
        ],
        "title": "DeepHealthResponse"
      },
      "ElevationPointResponse": {
        "properties": {
          "latitude": {
            "type": "number",
            "title": "Latitude",
            "description": "Requested latitude"
          },
          "longitude": {
            "type": "number",
            "title": "Longitude",
            "description": "Requested longitude"
          },
          "elevation": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Elevation",
            "description": "Elevation in meters (Z value)"
          }
        },
        "type": "object",
        "required": [
          "latitude",
          "longitude"
        ],
        "title": "ElevationPointResponse"
      },
      "ElevationProfileRequest": {
        "properties": {
          "path": {
            "items": {
              "items": {
                "type": "number"
              },
              "type": "array"
            },
            "type": "array",
            "title": "Path",
            "description": "List of [lat, lon] points for the profile path"
          }
        },
        "type": "object",
        "required": [
          "path"
        ],
        "title": "ElevationProfileRequest"
      },
      "ElevationProfileResponse": {
        "properties": {
          "elevations": {
            "items": {
              "type": "number"
            },
            "type": "array",
            "title": "Elevations",
            "description": "List of elevations in meters along the path"
          }
        },
        "type": "object",
        "required": [
          "elevations"
        ],
        "title": "ElevationProfileResponse"
      },
      "ElevationQueryRequest": {
        "properties": {
          "latitude": {
            "type": "number",
            "title": "Latitude",
            "description": "Target latitude (EPSG:4326)"
          },
          "longitude": {
            "type": "number",
            "title": "Longitude",
            "description": "Target longitude (EPSG:4326)"
          }
        },
        "type": "object",
        "required": [
          "latitude",
          "longitude"
        ],
        "title": "ElevationQueryRequest"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "HealthResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "description": "Operational status of the API",
            "example": "ok"
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "HealthResponse"
      },
      "InternalEvent": {
        "properties": {
          "event_type": {
            "type": "string",
            "title": "Event Type",
            "description": "Type of the internal event",
            "example": "project_saved"
          },
          "payload": {
            "additionalProperties": true,
            "type": "object",
            "title": "Payload",
            "description": "Event payload data"
          }
        },
        "type": "object",
        "required": [
          "event_type",
          "payload"
        ],
        "title": "InternalEvent"
      },
      "JobStatusResponse": {
        "properties": {
          "job_id": {
            "type": "string",
            "title": "Job Id",
            "description": "Unique job identifier"
          },
          "kind": {
            "type": "string",
            "title": "Kind",
            "description": "Job type (osm/geojson)"
          },
          "status": {
            "type": "string",
            "enum": [
              "queued",
              "processing",
              "completed",
              "failed"
            ],
            "title": "Status",
            "description": "Current job execution status"
          },
          "progress": {
            "type": "number",
            "title": "Progress",
            "description": "Job progress from 0.0 to 1.0"
          },
          "message": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Message",
            "description": "Human-readable status message"
          },
          "result": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/PrepareResponse"
              },
              {
                "type": "null"
              }
            ],
            "description": "Job result payload (only on completion)"
          },
          "error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Error",
            "description": "Error detail if job failed"
          },
          "created_at": {
            "type": "number",
            "title": "Created At",
            "description": "Unix timestamp of job creation"
          },
          "updated_at": {
            "type": "number",
            "title": "Updated At",
            "description": "Unix timestamp of last job update"
          }
        },
        "type": "object",
        "required": [
          "job_id",
          "kind",
          "status",
          "progress",
          "created_at",
          "updated_at"
        ],
        "title": "JobStatusResponse"
      },
      "PrepareGeoJsonRequest": {
        "properties": {
          "geojson": {
            "title": "Geojson",
            "description": "GeoJSON string or object to process"
          }
        },
        "type": "object",
        "required": [
          "geojson"
        ],
        "title": "PrepareGeoJsonRequest"
      },
      "PrepareJobRequest": {
        "properties": {
          "kind": {
            "type": "string",
            "enum": [
              "osm",
              "geojson"
            ],
            "title": "Kind",
            "description": "Type of data preparation job"
          },
          "latitude": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Latitude",
            "description": "Required for kind='osm'"
          },
          "longitude": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Longitude",
            "description": "Required for kind='osm'"
          },
          "radius": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Radius",
            "description": "Required for kind='osm'"
          },
          "geojson": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Geojson",
            "description": "Required for kind='geojson'"
          }
        },
        "type": "object",
        "required": [
          "kind"
        ],
        "title": "PrepareJobRequest"
      },
      "PrepareOsmRequest": {
        "properties": {
          "latitude": {
            "type": "number",
            "title": "Latitude",
            "description": "Target latitude (EPSG:4326)",
            "example": -21.7634
          },
          "longitude": {
            "type": "number",
            "title": "Longitude",
            "description": "Target longitude (EPSG:4326)",
            "example": -41.3235
          },
          "radius": {
            "type": "number",
            "title": "Radius",
            "description": "Search radius in meters",
            "example": 500.0
          }
        },
        "type": "object",
        "required": [
          "latitude",
          "longitude",
          "radius"
        ],
        "title": "PrepareOsmRequest"
      },
      "PrepareResponse": {
        "properties": {
          "crs_out": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Crs Out",
            "description": "Projected Coordinate Reference System",
            "example": "EPSG:31983"
          },
          "features": {
            "items": {
              "$ref": "#/components/schemas/CadFeature"
            },
            "type": "array",
            "title": "Features",
            "description": "List of CAD-ready features"
          },
          "cache_hit": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Cache Hit",
            "description": "Indicates if the result was served from cache"
          }
        },
        "type": "object",
        "required": [
          "features"
        ],
        "title": "PrepareResponse"
      },
      "ProjectUpdateRequest": {
        "properties": {
          "version": {
            "type": "integer",
            "title": "Version",
            "description": "Current version of the project for optimistic locking"
          },
          "project_name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Project Name",
            "description": "New project name"
          },
          "crs_out": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Crs Out",
            "description": "New CRS"
          }
        },
        "type": "object",
        "required": [
          "version"
        ],
        "title": "ProjectUpdateRequest"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      },
      "WebhookRegistrationRequest": {
        "properties": {
          "url": {
            "type": "string",
            "title": "Url",
            "description": "Target URL to receive webhook events",
            "example": "https://example.com/webhook"
          },
          "events": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Events",
            "description": "Optional list of events to subscribe to (default: all)"
          }
        },
        "type": "object",
        "required": [
          "url"
        ],
        "title": "WebhookRegistrationRequest"
      }
    }
  },
  "tags": [
    {
      "name": "Health",
      "description": "Health check endpoints"
    },
    {
      "name": "Jobs",
      "description": "Asynchronous job management"
    },
    {
      "name": "Prepare",
      "description": "Data preparation (OSM/GeoJSON)"
    },
    {
      "name": "Tools",
      "description": "Utility tools (elevation, etc.)"
    },
    {
      "name": "Webhooks",
      "description": "Dynamic webhook registration"
    },
    {
      "name": "Projects",
      "description": "Project metadata management"
    },
    {
      "name": "AI",
      "description": "AI-powered chat assistance"
    },
    {
      "name": "Audit",
      "description": "Cryptographic audit logging"
    }
  ]
}
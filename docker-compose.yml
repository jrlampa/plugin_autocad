services:
  backend:
    build:
      context: .
      dockerfile: src/backend/Dockerfile
    ports:
      - "8000:8000"
    volumes:
      - ./src/backend:/app/backend
    environment:
      - PYTHONUNBUFFERED=1
      - SISRUA_AUTH_TOKEN=${SISRUA_AUTH_TOKEN:-test-token}
      - SENTRY_DSN=${SENTRY_DSN:-}
      - SENTRY_ENVIRONMENT=${SENTRY_ENVIRONMENT:-production}
      - OPENTOPOGRAPHY_API_KEY=${OPENTOPOGRAPHY_API_KEY:-}
      - GROQ_API_KEY=${GROQ_API_KEY:-}
      - REDIS_URL=redis://redis:6379

  redis:
    image: redis:alpine
    ports:
      - "6379:6379"

  frontend:
    build:
      context: ./src/frontend
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    depends_on:
      - backend
    environment:
      - VITE_API_URL=/api
      - VITE_SENTRY_DSN=${VITE_SENTRY_DSN:-}

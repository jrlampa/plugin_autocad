TestCaseID,Title,Priority,Preconditions,Steps,ExpectedResult,Evidence
TC-MAN-000,Preparação do RUN (evidências + hashes),CRITICO,"Ter acesso ao instalador/bundle e permissões para ler caminhos; PowerShell disponível","1) Criar pasta `qa/out/manual/<RUN_ID>/` com subpastas `evidence/`, `logs/`, `artifacts/`; 2) Copiar e preencher `qa/manual/execution-record-template.md` como `qa/out/manual/<RUN_ID>/execution-record.md`; 3) Coletar versões do SO/AutoCAD/WebView2; 4) Gerar SHA-256 dos artefatos sob teste (instalador, backend EXE, `layers.json`, `mapeamento.json`, `prancha.dwg` e/ou bundle) e salvar em `artifacts-under-test.sha256.txt`","Existe um registro de execução preenchido + arquivo de hashes; RUN fica auto-contido e auditável","`qa/out/manual/<RUN_ID>/execution-record.md` + `qa/out/manual/<RUN_ID>/artifacts-under-test.sha256.txt`"
TC-MAN-001,Instalação e autoload do bundle,CRITICO,"Instalador executado; AutoCAD fechado; TC-MAN-000 concluído","1) Instalar sisRUA via EXE; 2) Abrir AutoCAD; 3) Verificar carregamento sem NETLOAD","Plugin carregado via ApplicationPlugins; comando SISRUA disponível","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-001_instalador_*.png` + `qa/out/manual/<RUN_ID>/evidence/TC-MAN-001_comando_*.png`"
TC-MAN-002,Abertura da paleta (UI),CRITICO,"Plugin carregado","1) Rodar comando SISRUA; 2) Aguardar UI","Paleta abre e UI renderiza; sem travar AutoCAD","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-002_paleta_*.png`"
TC-MAN-003,Gerar OSM e desenhar vias,ALTO,"Internet disponível (para OSM)","1) Abrir UI; 2) Definir ponto/raio; 3) Clique Gerar Projeto (OSM); 4) Aguardar","Polylines desenhadas em layers; progresso/feedback na UI; atribuição OSM aplicada","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-003_modelspace_*.png` + `qa/out/manual/<RUN_ID>/evidence/TC-MAN-003_layers_*.png` + `qa/out/manual/<RUN_ID>/evidence/TC-MAN-005_atribuicao_*.png`"
TC-MAN-004,Importar GeoJSON e desenhar,ALTO,"Arquivo .geojson válido disponível","1) Arrastar arquivo para UI; 2) Validar preview; 3) Clicar IMPORTAR PARA O AUTOCAD","Polylines desenhadas; layers respeitadas; erros tratados","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-004_preview_*.png` + `qa/out/manual/<RUN_ID>/evidence/TC-MAN-004_modelspace_*.png` + `qa/out/manual/<RUN_ID>/evidence/TC-MAN-004_layers_*.png`"
TC-MAN-005,Atribuição OSM no DWG,ALTO,"OSM executado","1) Após gerar OSM, procurar texto de atribuição no desenho","Existe MText com © OpenStreetMap contributors e link","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-005_atribuicao_*.png`"
TC-MAN-006,Logs do backend (produção),MEDIO,"Backend EXE em uso","1) Rodar SISRUA; 2) Executar uma operação; 3) Copiar logs do `%LOCALAPPDATA%\\sisRUA\\logs` para o RUN","backend.log existe e recebe logs; rotação funciona","`qa/out/manual/<RUN_ID>/logs/backend.log` + `qa/out/manual/<RUN_ID>/evidence/TC-MAN-006_logs_dir_*.png`"
TC-MAN-007,Privacidade / rede,MEDIO,"Ferramenta de captura opcional","1) Confirmar ausência de telemetria; 2) Validar que rede externa ocorre apenas ao gerar OSM","Sem conexões inesperadas; OSM dispara tráfego","`qa/out/manual/<RUN_ID>/execution-record.md` (seção checklist) + (opcional) `qa/out/manual/<RUN_ID>/logs/network_capture.*`"
TC-MAN-008,Trusted Locations (redução de popup),ALTO,"Instalação em %APPDATA% e/ou %ProgramData%","1) Instalar; 2) Observar warnings; 3) Verificar TRUSTEDPATHS no registro ou mensagem do instalador","TRUSTEDPATHS inclui sisRUA.bundle\\... ou instrução manual foi exibida","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-008_warning_*.png` + (opcional) `qa/out/manual/<RUN_ID>/artifacts/trustedpaths_export.*`"
TC-MAN-009,Verificação de Autorização (Backend),ALTO,"Backend rodando; Ferramenta para requisições HTTP (ex: Postman, curl)","1) Tentar acessar um endpoint sensível do backend (ex: /api/v1/jobs/prepare) SEM o cabeçalho 'X-SisRua-Token'; 2) Tentar acessar com um token INVÁLIDO; 3) Tentar acessar com um token VÁLIDO.","1) Requisição sem token deve ser rejeitada (HTTP 401/403); 2) Requisição com token inválido deve ser rejeitada (HTTP 401/403); 3) Requisição com token válido deve ser aceita (HTTP 200).","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-009_auth_*.png` + `qa/out/manual/<RUN_ID>/logs/backend.log`"
TC-MAN-010,Robustez de Payload (Backend),MEDIO,"Backend rodando; Ferramenta para requisições HTTP (ex: Postman, curl)","1) Enviar payload GeoJSON malformado para o backend; 2) Enviar payload excessivamente grande; 3) Enviar dados com tipos incorretos (ex: string onde espera double).","Backend deve retornar erros claros (HTTP 400/422) e não travar/crashar. O log deve registrar o erro.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-010_payload_*.png` + `qa/out/manual/<RUN_ID>/logs/backend.log`"
TC-MAN-011,Verificar Exibição do Aviso de Privacidade,CRITICO,"AutoCAD limpo (plugin nunca carregado); TC-MAN-000 concluído","1) Iniciar AutoCAD; 2) Rodar comando SISRUA pela primeira vez.","Aviso de privacidade deve ser exibido; opção de aceitar/recusar; UI não deve abrir se recusado.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-011_privacidade_*.png`"
TC-MAN-012,Verificar Ausência de Telemetria/Rede Externa Não Autorizada,ALTO,"Ferramenta de captura de tráfego de rede (ex: Wireshark)","1) Iniciar AutoCAD com plugin; 2) Monitorar tráfego de rede ANTES de usar qualquer funcionalidade que solicite dados externos (ex: Gerar OSM); 3) Usar funcionalidade Gerar OSM.","Não deve haver tráfego de rede externo não autorizado antes de Gerar OSM; Gerar OSM deve gerar tráfego esperado.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-012_rede_*.png` + (opcional) `qa/out/manual/<RUN_ID>/logs/network_capture.*`"
TC-MAN-013,Verificar Acesso a Dados Locais,MEDIO,"Após usar o plugin com geração de dados","1) Fechar AutoCAD; 2) Navegar até `%LOCALAPPDATA%\sisRUA`; 3) Verificar a existência de `cache/`, `logs/`, `backend_token.txt`, `backend_port.txt`, etc.","Todos os dados locais do plugin devem estar visíveis e acessíveis ao usuário.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-013_dados_locais_*.png`"
TC-MAN-014,Comando ""Limpar Dados Locais"",ALTO,"Plugin carregado; dados locais existentes","1) Rodar o comando ""Limpar Dados Locais"" (a ser implementado); 2) Verificar `%LOCALAPPDATA%\sisRUA`","Todos os dados locais do plugin devem ser removidos; backend deve ser reiniciado se necessário.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-014_limpar_dados_*.png`"
TC-MAN-015,Verificar Presença In-window da UI,CRITICO,"Plugin carregado; paleta sisRUA aberta","1) Verificar se a paleta sisRUA está integrada na janela do AutoCAD (não é uma janela separada); 2) Redimensionar e mover a janela principal do AutoCAD.","A paleta deve se comportar como um componente integrado do AutoCAD, redimensionando/movendo com a janela principal.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-015_inwindow_*.png`"
TC-MAN-016,Associatividade com Dados de Origem,ALTO,"Plugin carregado; entidades CAD geradas a partir de dados OSM/GeoJSON (FR-009 implementado)","1) Abrir um desenho com entidades geradas pelo plugin; 2) Modificar o arquivo de dados de origem (externo ao DWG); 3) Verificar se o plugin notifica sobre a alteração e oferece opção de atualização.","O plugin deve detectar a alteração nos dados de origem e notificar o usuário, permitindo a atualização do desenho.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-016_associatividade_*.png`"
TC-MAN-017,Verificação da Documentação do Usuário,MEDIO,"Documentação de usuário e suporte disponível (FR-010 implementado)","1) Acessar o guia de usuário e a documentação de suporte; 2) Avaliar clareza, abrangência e facilidade de localização das informações.","A documentação deve ser abrangente, clara e facilmente acessível, cobrindo instalação, uso, funcionalidades e FAQ.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-017_doc_usuario_*.png`"
TC-MAN-018,Inserção de Bloco via OSM,ALTO,"Internet disponível (para OSM); `blocks_mapping.json` configurado; (FR-011 implementado)","1) Abrir UI; 2) Definir ponto/raio com área que contenha elementos mapeados para blocos (ex: postes); 3) Clique Gerar Projeto (OSM); 4) Aguardar.","Blocos correspondentes devem ser inseridos no ModelSpace, com layer, escala e rotação corretos.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-018_osm_blocos_*.png` + `qa/out/manual/<RUN_ID>/logs/sisRUA_plugin_*.log`"
TC-MAN-019,Inserção de Bloco via GeoJSON,ALTO,"Arquivo .geojson válido com pontos e metadados de bloco; (FR-012 implementado)","1) Preparar um arquivo GeoJSON com geometria 'Point' e propriedades `block_name`, `block_filepath`; 2) Arrastar arquivo para UI; 3) Validar preview; 4) Clicar IMPORTAR PARA O AUTOCAD.","Blocos correspondentes devem ser inseridos no ModelSpace, com layer, escala e rotação corretos.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-019_geojson_blocos_*.png` + `qa/out/manual/<RUN_ID>/logs/sisRUA_plugin_*.log`"
TC-MAN-020,Padronização Gráfica de Blocos,ALTO,"Blocos inseridos via OSM ou GeoJSON; (FR-013 implementado)","1) Verificar propriedades dos blocos inseridos no AutoCAD (Layer, cor, escala, rotação); 2) Comparar com as definições em `blocks_mapping.json`.","Os blocos devem respeitar as padronizações definidas em `blocks_mapping.json` e ter suas propriedades gráficas corretas.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-020_padronizacao_blocos_*.png`"
TC-MAN-021,Salvar Projeto (SISRUA_SAVE_PROJECT),ALTO,"Projeto desenhado com `DrawCadFeatures`; (FR-014 implementado)","1) Desenhar um projeto com polylines e blocos; 2) Executar `SISRUA_SAVE_PROJECT`; 3) Fornecer um ID de projeto e nome (ou deixar ID em branco para gerar auto).","O projeto deve ser salvo no banco de dados SQLite; mensagem de sucesso exibida.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-021_save_project_*.png` + `qa/out/manual/<RUN_ID>/logs/sisRUA_plugin_*.log`"
TC-MAN-022,Listar Projetos Salvos,MEDIO,"Pelo menos um projeto salvo (via TC-MAN-021)","1) Executar `SISRUA_RELOAD_PROJECT`; 2) Observar a lista de projetos exibida na linha de comando.","A lista de projetos salvos (ID, Nome, Data) deve ser exibida corretamente.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-022_list_projects_*.png`"
TC-MAN-023,Recuperar e Redesenhar Projeto (SISRUA_RELOAD_PROJECT),ALTO,"Pelo menos um projeto salvo (via TC-MAN-021); (FR-015 implementado)","1) Abrir um desenho novo/vazio; 2) Executar `SISRUA_RELOAD_PROJECT`; 3) Digitar o ID de um projeto salvo.","O projeto selecionado deve ser carregado do SQLite e suas feições (polylines e blocos) redesenhadas no AutoCAD.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-023_reload_project_*.png` + `qa/out/manual/<RUN_ID>/logs/sisRUA_plugin_*.log`"
TC-MAN-024,Integridade dos Dados Recuperados,ALTO,"Projeto redesenhado (via TC-MAN-023); (NFR-006 implementado)","1) Após redesenhar o projeto, verificar propriedades das polylines (vértices, layers, larguras) e blocos (inserção, rotação, escala, layers, nome do bloco); 2) Comparar com o estado original ou dados de entrada.","As feições redesenhadas devem corresponder exatamente às propriedades dos dados originais salvos, sem perdas ou corrupções.","`qa/out/manual/<RUN_ID>/evidence/TC-MAN-024_data_integrity_*.png`"

